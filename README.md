# GarmageJigsaw



<p align="center"><img src="assest/images/garmagejigsaw.png" width="100%"></p>

We introduce GarmageJigsaw, a dedicated module that leverages Garmageâ€™s embedded 2D silhouettes and 3D spatial cues to robustly infer vertex-wise sewing correspondences, followed by post-processing routines that yield production-ready, vector-format sewing patterns. 



## ğŸ”¨ Installation

**Tested Environment:** `Ubuntu 22.04` + `CUDA 11.8` + `Python 3.8` + `PyTorch 1.10`

Clone the repo.

Install PyTorch and other dependencies:

```bash
conda create -n garmagejigsaw python=3.8
pip install -r requirements.txt
conda install cudatoolkit=11.8
pip install chamferdist
```



## ğŸ¤– Data Process

Download dataset refer to the **Data Preparation** part in the **[GarmageNet](https://github.com/Style3D/garmagenet-impl)**.

Preprocess training data:

```bash
# Preprocess Garmageset raw objs.
python data_process/garmageset/preprocess_stylexd.py \
	--objs_dir <garmageset-root>/raw \
	--output_root <garmageset-root>/garmagejigsaw_data/preprocessed_jigsaw_train

# Prepare datalist
python data_process/garmageset/get_dataset_split.py \
	--dataset_dir <garmageset-root>/garmagejigsaw_data/preprocessed_jigsaw_train \
    --output_dir <garmageset-root>/garmagejigsaw_data/datalist
```



## ğŸ¡ GarmageJigsaw Training

Update the following lines in the config file: **experiments/train/train.yaml**

```yaml
DATA:
  DATA_DIR: "<garmageset-root>/garmagejigsaw_data/preprocessed_jigsaw_train"
  DATASET_SPLIT_DIR: "<garmageset-root>/garmagejigsaw_data/datalist"
```

Train GarmageJigsaw.

```bash
python garmage_jigsaw/train_garmage_jigsaw.py \
	--cfg experiments/train/train.yaml
```



## ğŸ­ Sewing Recovery (Inference)

Preprocess Garmage generated by GarmageNet.

```bash
python garmage_jigsaw/extract_boundary_pts.py \
    --data_dir <garmagenet-generated-dir> \
    --delta 0.012 \
    --shape_dedup False
```

Recovery Sewing of Garmage generated by GarmageNet.

```bash
python garmage_jigsaw/inference_ps2es.py \
    --cfg experiments/train/train.yaml \
    --weight <GarmageJigsaw-ckpt> \
    --data_dir <garmagenet-generated-dir>_extracted \
    --update_dis_iter 2 --inf_noise_strength 6
```

## ğŸ“ƒ License
This project is licensed under the CC BY-NC-ND 4.0 License - see the [LICENSE](LICENSE) file for details.

## Acknowledgement
We extend our sincere gratitude to [Jigsaw](https://github.com/Jiaxin-Lu/Jigsaw) and [PuzzleFusion++](https://github.com/eric-zqwang/puzzlefusion-plusplus) who laid the foundation for GarmageJigsaw.

